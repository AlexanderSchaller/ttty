/*! plainterm.js 2018-10-23 */

var plainterm=function(){var e={commands:{},history:[],last:0,process:!1,version:"0.4.2"};function n(e,n,t=[],o){if(this.name=e,this.description=n,this.parameters=t,t.length>0){var i="";for(var r of t)i=i+" ["+r+"]";this.func=function(n){0==(n=n||!1)||n.length<t.length?a("usage: "+e+i):o(n)}}else this.func=o}function t(t){e.commands[t.name]=new n(t.name,t.description,t.parameters,t.func)}function a(n,t=!1){var a=document.createElement("p");if(!0===t){var o=document.createElement("span");o.innerHTML=n,o.className="command",a.innerHTML=e.prompt,e.container.display.appendChild(a),a.appendChild(o)}else a.innerHTML=n,e.container.display.appendChild(a)}function o(n=!0){e.history.length>0&&(!0===n&&e.last<e.history.length-1?(e.container.input.value=e.history[e.last],e.last++):!1===n&&e.last>0&&(e.container.input.value=e.history[e.last],e.last--))}return document.addEventListener("keydown",function(e){e.key;switch(e.key){case"ArrowUp":o();break;case"ArrowDown":o(!1)}}),{init:function(o){for(var i of(o.id=o.id||"terminal",o.welcome=o.welcome||"plainterm.js v. "+e.version,e.prompt=o.prompt||"$ ",void 0===o.help&&(o.help=!0),Object.keys(o.commands)))t(o.commands[i]);e.container=document.getElementById(o.id),function(n){n.className="terminal";var t=document.createElement("div"),a=document.createElement("div"),o=document.createElement("span");o.innerHTML=e.prompt;var i=document.createElement("input");for(var r of(t.className="terminal-container",a.className="terminal-type",i.setAttribute("type","text"),i.setAttribute("onkeypress","plainterm.run(this)"),n.appendChild(t),n.appendChild(a),document.getElementsByClassName("terminal-type")))r.appendChild(o),r.appendChild(i);e.container.display=n.firstElementChild,e.container.input=i,e.container.area=a,n.onclick=function(){i.focus()}}(e.container),a(o.welcome);var r=new CustomEvent("onInit");1==o.help&&(e.commands.help=new n("help","shows a help message",[],function(){Object.getOwnPropertyNames(e.commands).map(function(n){a(e.commands[n].name+" - "+e.commands[n].description)})})),e.container.dispatchEvent(r)},run:function(n){13==event.keyCode&&(a(n.value,!0),n.value.length>0&&function(n){var t=n.split(/\s+/),o=t[0];t.shift();var i=new CustomEvent("onCommand"),r=new CustomEvent("onCommand404");Object.getOwnPropertyNames(e.commands).indexOf(o)>-1?(e.commands[o].func(t),e.history.unshift(n),e.container.dispatchEvent(i)):(a(o+" - command not found"),e.container.dispatchEvent(r))}(n.value),n.value="",e.last=0,e.container.input.scrollIntoView())},print:a,hist:o,type:function(n,t,a=!1){e.container.area.style.display="none";var o=document.createElement("p");e.container.display.appendChild(o),1==a&&(o.innerHTML=e.prompt);var i=0;setTimeout(function a(){i<n.length?(o.innerHTML+=n.charAt(i),i++,setTimeout(a,t)):!1===e.process&&(e.container.area.style.display="flex")},t)},start:function(){e.container.area.style.display="none",e.process=!0,e.prompt="";var n=new CustomEvent("onProcessStart");e.container.dispatchEvent(n)},stop:function(){e.container.area.style.display="flex",e.process=!1,e.prompt=settings.prompt;var n=new CustomEvent("onProcessStop");e.container.dispatchEvent(n)}}}();